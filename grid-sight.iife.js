var __defProp=Object.defineProperty,__defNormalProp=(e,t,n)=>t in e?__defProp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,__publicField=(e,t,n)=>__defNormalProp(e,"symbol"!=typeof t?t+"":t,n);this.gridSight=function(){"use strict";function e(e,t={}){const{id:n=`table-${Math.random().toString(36).substr(2,9)}`,applyStyles:o=!0,onComplete:i}=t;e.id||(e.id=n);try{return e.dataset.gridSightProcessed="true",o&&function(e){if(e.classList.add("grid-sight-table"),!document.querySelector("style[data-grid-sight-styles]")){const e=document.createElement("style");e.setAttribute("data-grid-sight-styles","true"),e.textContent="\n      .grid-sight-table {\n        border-collapse: collapse;\n        width: 100%;\n        margin: 1em 0;\n        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n      }\n      .grid-sight-table th,\n      .grid-sight-table td {\n        border: 1px solid #ddd;\n        padding: 8px 12px;\n        text-align: left;\n      }\n      .grid-sight-table th {\n        background-color: #f5f5f5;\n        font-weight: 600;\n      }\n      .grid-sight-table tr:nth-child(even) {\n        background-color: #f9f9f9;\n      }\n      .grid-sight-table tr:hover {\n        background-color: #f1f1f1;\n      }\n    ",document.head.appendChild(e)}}(e),function(e){const t=e.querySelectorAll("td, th");t.forEach(((e,t)=>{e.hasAttribute("data-gs-cell-index")||e.setAttribute("data-gs-cell-index",t.toString())}))}(e),"function"==typeof i&&i(e),e}catch(s){throw console.error("Error processing table:",s),s}}const t={minUniqueValuesForCategorical:3,numericThreshold:.8,hasHeader:!0};function n(e){if(null==e)return null;if("number"==typeof e)return isFinite(e)?e:null;const t=e.trim();if(!t)return null;let n=t.replace(/[^\d.,-]/g,"");if(!n)return null;const o=n.startsWith("-");if(o&&(n=n.slice(1)),n.includes("-"))return null;const i=n.split(".");if(i.length>2)return null;if(i[0].includes(",")){const e=i[0].split(",");if(0===e[0].length||e[0].length>3)return null;for(let t=1;t<e.length;t++)if(3!==e[t].length)return null;n=e.join("")+(i[1]?`.${i[1]}`:"")}else if(2===i.length){if(i[1].includes(","))return null;n=i[0]+"."+i[1]}o&&(n="-"+n);const s=parseFloat(n);return isFinite(s)?s:null}function o(e){return null!==n(e)}function i(e,n={}){const{hasHeader:i}={...t,...n},s=(i?e.slice(1):[...e]).map((e=>null==e?void 0:e.trim())).filter((e=>!!e));return 0!==s.length&&s.every((e=>o(e)))}function s(e,n={}){const{minUniqueValuesForCategorical:i,hasHeader:s}={...t,...n},r=(s?e.slice(1):[...e]).map((e=>null==e?void 0:e.trim())).filter((e=>!!e));if(0===r.length)return!1;if(r.some(o))return!1;return new Set(r.map((e=>e.toLowerCase()))).size>=i}function r(e,t={}){if(!e.length)return[];const n=e[0].length,o=[];for(let r=0;r<n;r++){const n=e.map((e=>e[r]||""));i(n,t)?o.push("numeric"):s(n,t)?o.push("categorical"):o.push("unknown")}return o}function l(e){var t,n;if(!e.rows)return[];const o=[];for(let i=0;i<e.rows.length;i++){const s=e.rows[i],r=[];for(let e=0;e<s.cells.length;e++)r.push((null==(n=null==(t=s.cells[e])?void 0:t.textContent)?void 0:n.trim())||"");o.push(r)}return o}const a="gs-heatmap",c=["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f"],d=document.createElement("style");d.textContent="\n  .gs-heatmap-cell {\n    transition: background-color 0.2s ease;\n    position: relative;\n  }\n  .gs-heatmap-cell:hover {\n    outline: 2px solid #1976d2;\n    outline-offset: -1px;\n    z-index: 1;\n  }\n",document.head.querySelector("style[data-heatmap-styles]")||(d.setAttribute("data-heatmap-styles",""),document.head.appendChild(d));const u=new Set;function h(e,t,n){return`${e.id||e.dataset.gsId||"table"}-${t}-${n}`}function m(e,t,n){const o=h(e,t,n);return u.has(o)}function p(e,t,n,o){const i=h(e,t,n);o?u.add(i):u.delete(i)}function f(e,t,o="column",i={}){if(m(e,t,o))return;const{minValue:s,maxValue:r,colorScale:l=c}=i,d=[],u=[];if("column"===o){e.querySelectorAll(`tbody td:nth-child(${t+1})`).forEach((e=>{const t=n(e.textContent||"");null!==t&&(d.push(e),u.push(t))}))}else{const o=e.querySelector(`tbody tr:nth-child(${t})`);o&&Array.from(o.cells).forEach(((e,t)=>{if(0===t&&e.closest("th"))return;const o=n(e.textContent||"");null!==o&&(d.push(e),u.push(o))}))}if(0===u.length)return void console.warn("No numeric values found for heatmap");const h=void 0!==s?s:Math.min(...u),f=(void 0!==r?r:Math.max(...u))-h,g=`heatmap-style-${e.id||"table"}-${t}-${o}`;let b=document.getElementById(g);b||(b=document.createElement("style"),b.id=g,document.head.appendChild(b));let y="";if(0===f){const n=Math.floor(l.length/2),i="column"===o?`#${e.id||"table"} tbody td:nth-child(${t+1})`:`#${e.id||"table"} tbody tr:nth-child(${t}) td`;y=`${i} {\n      background-color: ${l[n]} !important;\n    }`}else{const n=[],i=[],s=Date.now();d.forEach(((t,o)=>{const r=(u[o]-h)/f,a=Math.min(l.length-1,Math.max(0,Math.floor(r*l.length))),c=`heatmap-cell-${o}-${s}`;t.classList.add(c,"gs-heatmap-cell"),y+=`#${e.id||"table"}.gs-heatmap .${c} {\n        background-color: ${l[a]} !important;\n      }`,n.push(c),i.push(t)})),e._heatmapInfos||(e._heatmapInfos=[]);const r={index:t,type:o,styleElement:b,cellClasses:n,cellElements:i};e._heatmapInfos.push(r),b.textContent=y,p(e,t,o,!0),e.classList.add(a),"test"===process.env.NODE_ENV&&e.offsetHeight;const c=new CustomEvent("gridsight:heatmapChanged",{bubbles:!0,detail:{table:e,index:t,type:o,active:!0}});e.dispatchEvent(c)}}function g(e,t,n){if(e._heatmapInfos&&0!==e._heatmapInfos.length)if(void 0!==t&&n){const o=e._heatmapInfos.findIndex((e=>e.index===t&&e.type===n));if(-1!==o){const i=e._heatmapInfos[o];i.styleElement&&i.styleElement.remove(),i.cellElements.forEach((e=>{e.classList.remove("gs-heatmap-cell"),e.style.removeProperty("background-color")})),p(e,t,n,!1),e._heatmapInfos.splice(o,1),0===e._heatmapInfos.length&&e.classList.remove(a);const s=new CustomEvent("gridsight:heatmapChanged",{bubbles:!0,detail:{table:e,index:t,type:n,active:!1}});return void e.dispatchEvent(s)}}else{[...e._heatmapInfos||[]].forEach((t=>{t.styleElement&&t.styleElement.remove(),t.cellElements.forEach((e=>{e.classList.remove("gs-heatmap-cell"),e.style.removeProperty("background-color")})),p(e,t.index,t.type,!1)})),e._heatmapInfos=[],e.classList.remove(a);const t=new CustomEvent("gridsight:heatmapChanged",{bubbles:!0,detail:{table:e,active:!1}});e.dispatchEvent(t)}}function b(e,t,n="column",o={}){m(e,t,n)?g(e,t,n):f(e,t,n,o)}const y="gs-enrichment-menu",v=[{id:"heatmap",label:"Heatmap",availableFor:["numeric"]},{id:"statistics",label:"Statistics",availableFor:["numeric"]}];function x(){document.querySelectorAll(`.${y}`).forEach((e=>{e.remove()}))}const w="gs-plus-icon",E="gs-has-plus-icon",C="gs-plus-icon--active";function S(e){e.querySelectorAll(`.${w}`).forEach((e=>e.remove()));e.querySelectorAll(`.${E}`).forEach((e=>e.classList.remove(E)))}function $(e,t){var o;if(e.querySelector(`.${w}`))return;let i="categorical";if("column"===t){const t=e.closest("tr");if(t){const s=Array.from(t.cells).indexOf(e),r=e.closest("table");if(r&&r.rows.length>0){const e=r.rows[1];if(e&&e.cells[s]){const t=(null==(o=e.cells[s].textContent)?void 0:o.trim())||"";i=null!==n(t)?"numeric":"categorical"}}}}else{const t=e.closest("tr");if(t){const e=Array.from(t.cells).slice(1).some((e=>{var t;return null!==n((null==(t=e.textContent)?void 0:t.trim())||"")}));i=e?"numeric":"categorical"}}const s=document.createElement("span");s.className=`${w} gs-${t}-plus`,s.textContent="+",s.style.marginLeft="4px",s.style.cursor="pointer",s.addEventListener("click",(n=>{n.stopPropagation(),x();if(s.classList.toggle(C)){const n=function(e,t){const n=document.createElement("div");return n.className=y,n.style.cssText="\n    position: absolute;\n    background: white;\n    border: 1px solid #e0e0e0;\n    border-radius: 4px;\n    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\n    z-index: 1000;\n    min-width: 180px;\n    overflow: hidden;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n    font-size: 13px;\n  ",v.filter((t=>t.availableFor.includes(e))).forEach((e=>{const o=document.createElement("div");o.className="gs-enrichment-menu-item",o.style.cssText="\n      display: flex;\n      align-items: center;\n      padding: 8px 12px;\n      cursor: pointer;\n      transition: background-color 0.1s;\n    ",o.innerHTML=`\n      <span class="gs-enrichment-menu-item-label">${e.label}</span>\n    `,o.addEventListener("click",(n=>{n.stopPropagation(),t(e.id)})),o.addEventListener("mouseenter",(()=>{o.style.backgroundColor="#f5f5f5"})),o.addEventListener("mouseleave",(()=>{o.style.backgroundColor=""})),n.appendChild(o)})),n}(i,(o=>{var i,r,l;console.log(`Selected enrichment: ${o} for ${t} header`);const a=new CustomEvent("gridsight:enrichmentSelected",{bubbles:!0,detail:{type:t,enrichmentType:o,header:e,headerIndex:"column"===t?Array.from((null==(i=e.parentElement)?void 0:i.children)||[]).indexOf(e):Array.from((null==(l=null==(r=e.closest("tr"))?void 0:r.parentElement)?void 0:l.children)||[]).indexOf(e.closest("tr"))}});e.dispatchEvent(a),n.remove(),s.classList.remove(C)}));document.body.appendChild(n),function(e,t){const n=t.getBoundingClientRect(),o=window.innerHeight;let i=n.bottom+window.scrollY,s=n.left+window.scrollX;n.bottom+e.offsetHeight>o&&(i=n.top+window.scrollY-e.offsetHeight),s+e.offsetWidth>window.innerWidth&&(s=window.innerWidth-e.offsetWidth-10),e.style.top=`${Math.max(0,i)}px`,e.style.left=`${Math.max(0,s)}px`}(n,s);const o=e=>{n.contains(e.target)||e.target===s||(n.remove(),s.classList.remove(C),document.removeEventListener("click",o))};setTimeout((()=>{document.addEventListener("click",o)}),0)}})),e.addEventListener("mouseenter",(()=>{s.classList.contains(C)||(s.style.opacity="1")})),e.addEventListener("mouseleave",(()=>{s.classList.contains(C)||(s.style.opacity="0.5")})),e.appendChild(s),e.classList.add(E)}const L=`\n  .${w} {\n    opacity: 0.5;\n    transition: all 0.2s ease;\n    cursor: pointer;\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n    width: 16px;\n    height: 16px;\n    border-radius: 3px;\n    background-color: rgba(0, 0, 0, 0.05);\n    margin-left: 4px;\n    font-size: 12px;\n    font-weight: bold;\n    user-select: none;\n  }\n  \n  .${w}:hover {\n    opacity: 1;\n    background-color: rgba(0, 0, 0, 0.1);\n  }\n  \n  .${C} {\n    opacity: 1 !important;\n    background-color: #1976d2;\n    color: white;\n  }\n  \n  .${E} {\n    position: relative;\n    cursor: pointer;\n  }\n  \n  .${E}:hover {\n    background-color: rgba(25, 118, 210, 0.08);\n  }\n`;function k(e){if(0===e.length)return 0;var t,n=e[0],o=0;if("number"!=typeof n)return Number.NaN;for(var i=1;i<e.length;i++){if("number"!=typeof e[i])return Number.NaN;t=n+e[i],Math.abs(n)>=Math.abs(e[i])?o+=n-t+e[i]:o+=e[i]-t+n,n=t}return n+o}function _(e){if(0===e.length)throw new Error("mean requires at least one data point");return k(e)/e.length}function M(e){if(0===e.length)throw new Error("variance requires at least one data point");return function(e){var t,n,o=_(e),i=0;for(n=0;n<e.length;n++)i+=(t=e[n]-o)*t;return i}(e)/e.length}function I(e){if(1===e.length)return 0;var t=M(e);return Math.sqrt(t)}function N(e){if(0===e.length)throw new Error("min requires at least one data point");for(var t=e[0],n=1;n<e.length;n++)e[n]<t&&(t=e[n]);return t}function T(e){if(0===e.length)throw new Error("max requires at least one data point");for(var t=e[0],n=1;n<e.length;n++)e[n]>t&&(t=e[n]);return t}function A(e,t){var n=e.length*t;if(0===e.length)throw new Error("quantile requires at least one data point.");if(t<0||t>1)throw new Error("quantiles must be between 0 and 1");return 1===t?e[e.length-1]:0===t?e[0]:n%1!=0?e[Math.ceil(n)-1]:e.length%2==0?(e[n-1]+e[n])/2:e[n]}function F(e,t,n,o){for(n=n||0,o=o||e.length-1;o>n;){if(o-n>600){var i=o-n+1,s=t-n+1,r=Math.log(i),l=.5*Math.exp(2*r/3),a=.5*Math.sqrt(r*l*(i-l)/i);s-i/2<0&&(a*=-1),F(e,t,Math.max(n,Math.floor(t-s*l/i+a)),Math.min(o,Math.floor(t+(i-s)*l/i+a)))}var c=e[t],d=n,u=o;for(B(e,n,t),e[o]>c&&B(e,n,o);d<u;){for(B(e,d,u),d++,u--;e[d]<c;)d++;for(;e[u]>c;)u--}e[n]===c?B(e,n,u):B(e,++u,o),u<=t&&(n=u+1),t<=u&&(o=u-1)}}function B(e,t,n){var o=e[t];e[t]=e[n],e[n]=o}function q(e,t){var n=e.slice();if(Array.isArray(t)){!function(e,t){for(var n=[0],o=0;o<t.length;o++)n.push(D(e.length,t[o]));n.push(e.length-1),n.sort(P);var i=[0,n.length-1];for(;i.length;){var s=Math.ceil(i.pop()),r=Math.floor(i.pop());if(!(s-r<=1)){var l=Math.floor((r+s)/2);H(e,n[l],Math.floor(n[r]),Math.ceil(n[s])),i.push(r,l,l,s)}}}(n,t);for(var o=[],i=0;i<t.length;i++)o[i]=A(n,t[i]);return o}return H(n,D(n.length,t),0,n.length-1),A(n,t)}function H(e,t,n,o){t%1==0?F(e,t,n,o):(F(e,t=Math.floor(t),n,o),F(e,t+1,t+1,o))}function P(e,t){return e-t}function D(e,t){var n=e*t;return 1===t?e-1:0===t?0:n%1!=0?Math.ceil(n)-1:e%2==0?n-.5:n}const z="gs-statistics-popup",j="gs-statistics-popup--visible",O="gs-statistics-popup__header",V="gs-statistics-popup__title",U="gs-statistics-popup__close",W="gs-statistics-popup__content",R="gs-statistics-popup__stat",Y="gs-statistics-popup__stat-label",G="gs-statistics-popup__stat-value",K=`\n.${z} {\n  position: absolute;\n  background: white;\n  border: 1px solid #e0e0e0;\n  border-radius: 6px;\n  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);\n  z-index: 10000;\n  min-width: 280px;\n  max-width: 320px;\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n  font-size: 13px;\n  line-height: 1.4;\n  opacity: 0;\n  transform: translateY(-10px);\n  transition: opacity 0.2s ease, transform 0.2s ease;\n  pointer-events: none;\n}\n\n.${j} {\n  opacity: 1;\n  transform: translateY(0);\n  pointer-events: auto;\n}\n\n.${O} {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 10px 12px;\n  border-bottom: 1px solid #f0f0f0;\n}\n\n.${V} {\n  margin: 0;\n  font-size: 14px;\n  font-weight: 600;\n  color: #333;\n}\n\n.${U} {\n  background: none;\n  border: none;\n  font-size: 16px;\n  cursor: pointer;\n  color: #999;\n  padding: 2px 6px;\n  border-radius: 3px;\n  line-height: 1;\n}\n\n.${U}:hover {\n  background: #f5f5f5;\n  color: #666;\n}\n\n.${W} {\n  padding: 12px;\n}\n\n.${R} {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 6px 0;\n  border-bottom: 1px solid #f8f8f8;\n}\n\n.${R}:last-child {\n  border-bottom: none;\n}\n\n.${Y} {\n  color: #666;\n  margin-right: 12px;\n}\n\n.${G} {\n  font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;\n  font-size: 12px;\n  color: #333;\n  text-align: right;\n  flex: 1;\n}\n`;class X{constructor(){__publicField(this,"element"),__publicField(this,"contentElement"),__publicField(this,"closeButton"),__publicField(this,"onCloseCallback",null),__publicField(this,"handleOutsideClick",(e=>{this.element.classList.contains(j)&&!this.element.contains(e.target)&&this.hide()})),__publicField(this,"handleKeyDown",(e=>{"Escape"===e.key&&this.element.classList.contains(j)&&this.hide()})),this.injectStyles(),this.element=document.createElement("div"),this.element.className=z,this.element.setAttribute("role","dialog"),this.element.setAttribute("aria-labelledby","gs-statistics-popup-title");const e=document.createElement("div");e.className=O;const t=document.createElement("h3");t.className=V,t.id="gs-statistics-popup-title",t.textContent="Column Statistics",this.closeButton=document.createElement("button"),this.closeButton.className=U,this.closeButton.innerHTML="&times;",this.closeButton.setAttribute("aria-label","Close"),this.closeButton.addEventListener("click",(()=>this.hide())),e.appendChild(t),e.appendChild(this.closeButton),this.contentElement=document.createElement("div"),this.contentElement.className=W,this.element.appendChild(e),this.element.appendChild(this.contentElement),document.body.appendChild(this.element),document.addEventListener("click",this.handleOutsideClick),document.addEventListener("keydown",this.handleKeyDown)}injectStyles(){if(document.getElementById("gs-statistics-popup-styles"))return;const e=document.createElement("style");e.id="gs-statistics-popup-styles",e.textContent=K,document.head.appendChild(e)}createStatItem(e,t){const n=document.createElement("div");n.className=R;const o=document.createElement("span");o.className=Y,o.textContent=e;const i=document.createElement("span");return i.className=G,i.textContent=String(t),n.appendChild(o),n.appendChild(i),n}formatNumber(e,t=2){return Number.isFinite(e)?e.toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:t}):"N/A"}show(e,t){this.contentElement.innerHTML="",this.contentElement.appendChild(this.createStatItem("Count",e.count.toString())),this.contentElement.appendChild(this.createStatItem("Sum",this.formatNumber(e.sum))),this.contentElement.appendChild(this.createStatItem("Min",this.formatNumber(e.min))),this.contentElement.appendChild(this.createStatItem("Max",this.formatNumber(e.max))),this.contentElement.appendChild(this.createStatItem("Mean",this.formatNumber(e.mean))),this.contentElement.appendChild(this.createStatItem("Median",this.formatNumber(e.median))),this.contentElement.appendChild(this.createStatItem("Std Dev",this.formatNumber(e.stdDev))),this.contentElement.appendChild(this.createStatItem("Variance",this.formatNumber(e.variance))),this.positionPopup(t),this.element.classList.add(j),this.closeButton.focus()}hide(){this.element.classList.remove(j),this.onCloseCallback&&this.onCloseCallback()}positionPopup(e){const t=e.getBoundingClientRect(),n=window.scrollX||document.documentElement.scrollLeft,o=window.scrollY||document.documentElement.scrollTop,i=t.bottom+o+5,s=t.left+n;this.element.style.top=`${i}px`,this.element.style.left=`${s}px`;const r=window.innerWidth,l=this.element.offsetWidth;s+l>r&&(this.element.style.left=r-l-10+"px")}onClose(e){this.onCloseCallback=e}destroy(){document.removeEventListener("click",this.handleOutsideClick),document.removeEventListener("keydown",this.handleKeyDown),this.element.parentNode&&this.element.parentNode.removeChild(this.element)}}const J="grid-sight-toggle",Q="grid-sight-toggle-container",Z="grid-sight-toggle--active",ee="grid-sight-enabled",te=document.createElement("style");te.textContent=L,document.head.appendChild(te);function ne(e){var t,o;const i=e,{type:s,enrichmentType:r,header:l,headerIndex:a}=i.detail;console.log(`Enrichment selected: ${r} for ${s} header at index ${a}`);const c=l.closest("table");if(c){if(window._gsStatisticsPopup||(window._gsStatisticsPopup=new X),"heatmap"===r){if("column"===s){const e=l.cellIndex;e>=0&&b(c,e,"column")}else if("row"===s){const e=Array.from((null==(o=null==(t=l.closest("tr"))?void 0:t.parentElement)?void 0:o.children)||[]).indexOf(l.closest("tr"));e>=0&&b(c,e,"row")}}else if("statistics"===r&&"column"===s){const e=l.cellIndex;if(e>=0)try{const t=function(e,t){var o;const i=[],s=(null==(o=e.tBodies[0])?void 0:o.rows)||[];for(let r=0;r<s.length;r++){const e=s[r].cells[t];if(!e)continue;const o=n(e.textContent||"");null!==o&&i.push(o)}return i}(c,e),o=function(e){if(!e.length)throw new Error("Cannot calculate statistics for an empty array");const t=e.filter(Number.isFinite);if(0===t.length)throw new Error("No valid numeric values provided");return{count:t.length,sum:k(t),min:N(t),max:T(t),mean:_(t),median:(n=t,+q(n,.5)),stdDev:I(t),variance:M(t)};var n}(t);window._gsStatisticsPopup.show(o,l)}catch(d){console.error("Error calculating statistics:",d),alert(`Error: ${d instanceof Error?d.message:"Unknown error"}`)}}if("statistics"!==r){const e=new CustomEvent(`gridsight:enrichment:${r}`,{bubbles:!0,detail:{type:s,header:l,headerIndex:a}});l.dispatchEvent(e)}}}function oe(e){var t;const n=(null==(t=e.tHead)?void 0:t.rows[0])||e.rows[0];if(!(null==n?void 0:n.cells.length))return console.warn("Could not find a suitable cell to inject the Grid-Sight toggle"),!1;const o=n.cells[0];if(o.querySelector(`.${J}, .${Q}`))return!1;try{const t=function(){const e=document.createElement("div");e.className=Q;const t=document.createElement("button");return t.className=J,t.textContent="GS",t.setAttribute("aria-label","Toggle Grid-Sight"),t.setAttribute("aria-expanded","false"),t.setAttribute("role","button"),t.setAttribute("tabindex","0"),t.style.cssText="\n    cursor: pointer;\n    border: 1px solid #ccc;\n    background: #f8f8f8;\n    border-radius: 3px;\n    padding: 2px 6px;\n    font-size: 11px;\n    font-weight: bold;\n    color: #555;\n    margin-right: 8px;\n    vertical-align: middle;\n    transition: all 0.2s ease;\n  ",t.addEventListener("mouseenter",(()=>{t.style.background="#e8e8e8",t.style.borderColor="#999"})),t.addEventListener("mouseleave",(()=>{t.style.background="#f8f8f8",t.style.borderColor="#ccc"})),t.addEventListener("keydown",(e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),t.click())})),e.appendChild(t),e}(),n=t.querySelector(`.${J}`);return o.insertBefore(t,o.firstChild),n&&n.addEventListener("click",(t=>{t.stopPropagation();const o=n.closest(`.${Q}`),i=n.classList.toggle(Z);null==o||o.classList.toggle(Z,i),n.setAttribute("aria-expanded",String(i));const s=new CustomEvent("gridsight:toggle",{bubbles:!0,detail:{active:i,target:t.target}});if(n.dispatchEvent(s),i){e.classList.add(ee);const t=Array.from(e.rows).map((e=>Array.from(e.cells).map((e=>e.textContent||"")))),{columnTypes:n}=function(e,t={}){const n=r(e,t),o=n.filter((e=>"numeric"===e||"categorical"===e)).length;return{columnTypes:n,isSuitable:o>=1}}(t);!function(e,t){S(e);const n=e.rows[0];if(n){Array.from(n.cells).forEach(((e,n)=>{const o=t[n];"numeric"!==o&&"categorical"!==o||$(e,"column")}));for(let t=1;t<e.rows.length;t++){const n=e.rows[t];n.cells.length&&$(n.cells[0],"row")}}}(e,n),e.addEventListener("gridsight:enrichmentSelected",ne)}else e.classList.remove(ee),S(e),x(),e.removeEventListener("gridsight:enrichmentSelected",ne)})),e.classList.add("grid-sight-enabled"),!0}catch(i){return console.error("Failed to inject Grid-Sight toggle:",i),!1}}const ie=new Map,se={version:"0.1.0",init(e={}){return document.querySelectorAll("table").forEach(((t,n)=>{if(this.isValidTable(t))try{this.processTable(t,{id:`table-${n}`,...e})}catch(o){console.error(`Failed to process table ${n}:`,o)}else console.warn(`Skipping invalid table at index ${n}: Table must have at least two rows`)})),this},processTable(t,n={}){if(!t)throw new Error("No table element provided");t.id||(t.id=n.id||`grid-sight-${Math.random().toString(36).substr(2,9)}`);const o=e(t,n);ie.set(t.id,t);try{oe(t)}catch(i){console.warn("Failed to inject UI elements:",i)}return o},isValidTable(e){if(!(e&&e instanceof HTMLTableElement))return!1;return e.rows.length>=2},getTableById:e=>ie.get(e),getAllTables:()=>Array.from(ie.values()),applyHeatmap(e,t,n="column",o={}){const i="string"==typeof e?this.getTableById(e):e;if(!i)throw new Error("Table not found");f(i,t,n,o)},removeHeatmap(e,t,n){if("string"==typeof e){const o=this.getTableById(e);o&&g(o,t,n)}else g(e,t,n)},toggleHeatmap(e,t,n="column",o={}){const i="string"==typeof e?this.getTableById(e):e;if(!i)throw new Error("Table not found");b(i,t,n,o)},isHeatmapActive(e,t,n="column"){const o="string"==typeof e?this.getTableById(e):e;return!!o&&m(o,t,n)},getColumnType(e,t){const n="string"==typeof e?this.getTableById(e):e;if(!n)throw new Error("Table not found");return r(l(n))[t]||"unknown"},getTableStructure(e){var t;const n="string"==typeof e?this.getTableById(e):e;if(!n)throw new Error("Table not found");const o=l(n);return{rows:o.length,cols:(null==(t=o[0])?void 0:t.length)||0,hasHeader:this.detectIfTableHasHeader(n)}},detectIfTableHasHeader(e){if(e.rows.length<2)return!1;const t=e.rows[0],n=e.rows[1],o=Array.from(t.cells).filter((e=>e.textContent&&""!==e.textContent.trim())).length;if(0===o)return!1;return o>=Array.from(n.cells).filter((e=>e.textContent&&""!==e.textContent.trim())).length}};return"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(()=>{se.init()})):setTimeout((()=>se.init()),0),"undefined"!=typeof window&&(window.gridSight=se),"undefined"!=typeof globalThis&&(globalThis.gridSight=se),"undefined"!=typeof module&&module.exports&&(module.exports=se),se}();
//# sourceMappingURL=grid-sight.iife.js.map
